# Railway Production Environment Variables (template)
# Copy these values into Railway dashboard → Settings → Secrets
# Do NOT commit real secrets to git.
# Do NOT set PORT (Railway sets it automatically)
# Do NOT set REACT_APP_BACKEND_URL in production (frontend uses relative URLs)

# Node Environment
NODE_ENV=production

# Frontend URL for CORS (must match your public production URL exactly)
CLIENT_BASE_URL=https://wmv-cycling-series-production.up.railway.app

# SQLite database path (requires a Railway Volume mounted at /data)
DATABASE_PATH=/data/wmv.db

# Strava API Credentials (from https://www.strava.com/settings/api)
STRAVA_CLIENT_ID=YOUR_PROD_STRAVA_CLIENT_ID
STRAVA_CLIENT_SECRET=YOUR_PROD_STRAVA_CLIENT_SECRET

# OAuth Redirect URI (must match Strava App settings and this service's domain)
STRAVA_REDIRECT_URI=https://wmv-cycling-series-production.up.railway.app/auth/strava/callback

# Session Secret (generate a strong random string for production)
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
SESSION_SECRET=REPLACE_WITH_RANDOM_BASE64

# Token Encryption Key for encrypting Strava tokens (32-byte hex string)
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
TOKEN_ENCRYPTION_KEY=REPLACE_WITH_64_HEX_CHARS

# Admin Athlete IDs (comma-separated list of Strava athlete IDs)
# Example: ADMIN_ATHLETE_IDS=12345678,87654321
ADMIN_ATHLETE_IDS=

# ==========================================
# WEBHOOK CONFIGURATION (Optional)
# ==========================================

# Enable Strava webhook subscriptions for real-time activity updates
# Set to 'true' to enable, 'false' or unset to disable (default: disabled)
# If disabled, use admin "Fetch Results" button to manually collect activities
WEBHOOK_ENABLED=false

# Webhook Verification Token (required if WEBHOOK_ENABLED=true)
# Random string used to verify requests are from Strava
# Generate with: openssl rand -hex 32 or node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Keep this secret - only Strava and your app should know it
WEBHOOK_VERIFY_TOKEN=

# Webhook Callback URL (required if WEBHOOK_ENABLED=true)
# Public HTTPS URL where Strava sends webhook events
# Production example: https://your-railway-domain.railway.app/webhooks/strava
WEBHOOK_CALLBACK_URL=

# Persist webhook events to database (REQUIRED if WEBHOOK_ENABLED=true)
# Events are marked as processed (success) or failed (with error message)
# Required for admin dashboard webhook status metrics
WEBHOOK_PERSIST_EVENTS=false

# Maximum database size in MB (for webhook storage monitoring)
# Default: 256MB if not set
# Webhooks auto-disable when database reaches 95% of this limit
# MAX_DATABASE_SIZE=256

# Needed for non-root to have write access to the database file
RAILWAY_RUN_UID=0