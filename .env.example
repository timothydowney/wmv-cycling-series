# Application Environment Variables
# Copy this file to .env and update as needed

# ==========================================
# BACKEND CONFIGURATION
# ==========================================

# Node environment
NODE_ENV=development

# URL Configuration (local development with split frontend/backend)
# For development: specify both frontend and backend URLs
# For production: use APP_BASE_URL instead (see .env.railway.example)
FRONTEND_URL=http://localhost:5173
BACKEND_URL=http://localhost:3001

# Strava API Credentials
# Get these from https://www.strava.com/settings/api
STRAVA_CLIENT_ID=your_client_id_here
STRAVA_CLIENT_SECRET=your_client_secret_here

# Database path
DATABASE_PATH=./data/wmv.db

# Session Secret (generate with: openssl rand -base64 32 or node -e "console.log(require('crypto').randomBytes(32).toString('base64'))")
SESSION_SECRET=your-random-secret-here

# Token Encryption Key (generate with: openssl rand -hex 32 or node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
# Used to encrypt OAuth tokens at rest in database
TOKEN_ENCRYPTION_KEY=your-random-hex-here

# Strava Webhook API URL (for webhook subscription calls only)
# Used ONLY for webhook registration with Strava, not general API calls
# Development: http://localhost:4000 (when running mock-strava locally)
# Production: https://www.strava.com (real Strava)
STRAVA_WEBHOOK_API_URL=https://www.strava.com

# Admin Athlete IDs (comma-separated list of Strava athlete IDs who should be admins)
# Find your Strava athlete ID: https://www.strava.com/settings/profile (look at URL)
# Example: ADMIN_ATHLETE_IDS=12345678,87654321
# If empty, no one has admin access (safe default)
ADMIN_ATHLETE_IDS=

# ==========================================
# WEBHOOK CONFIGURATION (Optional)
# ==========================================

# Enable Strava webhook subscriptions for real-time activity updates
# Set to 'true' to enable, 'false' or unset to disable (default: disabled)
# If disabled, use admin "Fetch Results" button to manually collect activities
WEBHOOK_ENABLED=false

# Webhook Verification Token (required if WEBHOOK_ENABLED=true)
# Random string used to verify requests are from Strava
# Generate with: openssl rand -hex 32 or node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Keep this secret - only Strava and your app should know it
WEBHOOK_VERIFY_TOKEN=

# Persist webhook events to database (REQUIRED if WEBHOOK_ENABLED=true)
# If true, all webhook events are persisted to database (webhook_event table)
# Events are marked as processed (success) or failed (with error message)
# Required for admin dashboard webhook status metrics
# Can be checked with:
#   SELECT * FROM webhook_event ORDER BY created_at DESC LIMIT 20;
# Set to 'true' when webhooks enabled, 'false' otherwise (default: false)
WEBHOOK_PERSIST_EVENTS=false

